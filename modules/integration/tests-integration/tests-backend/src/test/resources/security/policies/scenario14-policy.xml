<!--
  ~ Copyright 2005-2007 WSO2, Inc. (http://wso2.com)
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<wsp:Policy wsu:Id="SecConEncrUsername"
            xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"
            xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy"
            xmlns:sp="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy">
	<wsp:ExactlyOne>
		<wsp:All>
			<sp:SymmetricBinding>
				<wsp:Policy>
					<sp:ProtectionToken>
						<wsp:Policy>
							<sp:SecureConversationToken sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient">
								<wsp:Policy>
									<sp:BootstrapPolicy>
											<wsp:Policy>
												<sp:SymmetricBinding>
													<wsp:Policy>
														<sp:ProtectionToken>
															<wsp:Policy>
																<sp:X509Token sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/Never">
																	<wsp:Policy>
																		<sp:RequireThumbprintReference/>
																		<sp:WssX509V3Token10/>
																	</wsp:Policy>
																</sp:X509Token>
															</wsp:Policy>
														</sp:ProtectionToken>
														<sp:AlgorithmSuite>
															<wsp:Policy>
																<sp:Basic256/>
															</wsp:Policy>
														</sp:AlgorithmSuite>
														<sp:Layout>
															<wsp:Policy>
																<sp:Lax/>
															</wsp:Policy>
														</sp:Layout>
														<sp:IncludeTimestamp/>
														<sp:OnlySignEntireHeadersAndBody/>
													</wsp:Policy>
												</sp:SymmetricBinding>
												<sp:SignedParts>
													<sp:Body/>
												</sp:SignedParts>
												<sp:EncryptedParts>
									                <sp:Body/>
									            </sp:EncryptedParts>
												<sp:SignedSupportingTokens>
													<wsp:Policy>
														<sp:UsernameToken sp:IncludeToken="http://schemas.xmlsoap.org/ws/2005/07/securitypolicy/IncludeToken/AlwaysToRecipient">
															<wsp:Policy>
																<sp:WssUsernameToken10/>
															</wsp:Policy>
														</sp:UsernameToken>
													</wsp:Policy>
												</sp:SignedSupportingTokens>
												<sp:Wss11>
													<wsp:Policy>
														<sp:MustSupportRefKeyIdentifier/>
														<sp:MustSupportRefIssuerSerial/>
														<sp:MustSupportRefThumbprint/>
														<sp:MustSupportRefEncryptedKey/>
														<sp:RequireSignatureConfirmation/>
													</wsp:Policy>
												</sp:Wss11>
												<sp:Trust10>
													<wsp:Policy>
														<sp:MustSupportIssuedTokens/>
														<sp:RequireClientEntropy/>
														<sp:RequireServerEntropy/>
													</wsp:Policy>
												</sp:Trust10>
											</wsp:Policy>
									</sp:BootstrapPolicy>
								</wsp:Policy>
							</sp:SecureConversationToken>
						</wsp:Policy>
					</sp:ProtectionToken>
					<sp:AlgorithmSuite>
						<wsp:Policy>
							<sp:Basic256/>
						</wsp:Policy>
					</sp:AlgorithmSuite>
					<sp:Layout>
						<wsp:Policy>
							<sp:Lax/>
						</wsp:Policy>
					</sp:Layout>
					<sp:IncludeTimestamp/>
					<sp:OnlySignEntireHeadersAndBody/>
				</wsp:Policy>
			</sp:SymmetricBinding>
			<sp:EncryptedParts>
                <sp:Body/>
            </sp:EncryptedParts>
			<sp:Wss11>
				<wsp:Policy>
					<sp:MustSupportRefKeyIdentifier/>
					<sp:MustSupportRefIssuerSerial/>
					<sp:MustSupportRefThumbprint/>
					<sp:MustSupportRefEncryptedKey/>
				</wsp:Policy>
			</sp:Wss11>
			<sp:Trust10>
				<wsp:Policy>
					<sp:MustSupportIssuedTokens/>
					<sp:RequireClientEntropy/>
					<sp:RequireServerEntropy/>
				</wsp:Policy>
			</sp:Trust10>
		</wsp:All>
	</wsp:ExactlyOne>
</wsp:Policy>

